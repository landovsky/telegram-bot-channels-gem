<div class="mb-6">
  <h1 class="text-2xl font-bold text-gray-900">Subscriptions</h1>
  <p class="mt-1 text-sm text-gray-500"><%= @subscriptions.count %> total</p>
</div>

<div class="bg-white shadow-sm rounded-lg border border-gray-200 overflow-hidden">
  <table class="min-w-full divide-y divide-gray-200">
    <thead class="bg-gray-50">
      <tr>
        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Username</th>
        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">First Name</th>
        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Chat ID</th>
        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Subscribed</th>
        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
      </tr>
    </thead>
    <tbody class="bg-white divide-y divide-gray-200">
      <% @subscriptions.each do |subscription| %>
        <tr>
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
            <%= subscription.username || "-" %>
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">
            <%= subscription.first_name || "-" %>
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 font-mono">
            <%= subscription.chat_id %>
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            <% if subscription.active? %>
              <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">Active</span>
            <% else %>
              <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800">Inactive</span>
            <% end %>
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
            <%= subscription.created_at.strftime("%Y-%m-%d %H:%M") %>
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-right text-sm space-x-2">
            <%= button_to subscription.active? ? "Deactivate" : "Activate",
                  telegram_bot_engine.admin_subscription_path(subscription),
                  method: :patch,
                  class: "inline-flex items-center px-3 py-1.5 border border-gray-300 rounded text-xs font-medium #{subscription.active? ? 'text-yellow-700 hover:bg-yellow-50' : 'text-green-700 hover:bg-green-50'} bg-white" %>
            <%= button_to "Delete",
                  telegram_bot_engine.admin_subscription_path(subscription),
                  method: :delete,
                  data: { turbo_confirm: "Are you sure you want to delete this subscription?" },
                  class: "inline-flex items-center px-3 py-1.5 border border-red-300 rounded text-xs font-medium text-red-700 bg-white hover:bg-red-50" %>
          </td>
        </tr>
      <% end %>

      <% if @subscriptions.empty? %>
        <tr>
          <td colspan="6" class="px-6 py-12 text-center text-sm text-gray-500">
            No subscriptions yet.
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
